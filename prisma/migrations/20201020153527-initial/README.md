# Migration `20201020153527-initial`

This migration has been generated by Brian at 10/20/2020, 10:35:27 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "public"."UserRole" AS ENUM ('ADMIN', 'EDITOR')

CREATE TYPE "public"."PostStatus" AS ENUM ('DRAFT', 'PUBLISHED')

CREATE TABLE "public"."User" (
"id" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
"name" text   ,
"rating" Decimal(65,30)   NOT NULL ,
"roles" "UserRole"[]  ,
"email" text   NOT NULL ,
"password" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Post" (
"id" text   NOT NULL ,
"title" text   NOT NULL ,
"blogId" integer   ,
"status" "PostStatus"  NOT NULL ,
"authorId" text   ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Tag" (
"id" SERIAL,
"value" text   NOT NULL ,
"postId" text   ,
PRIMARY KEY ("id")
)

CREATE UNIQUE INDEX "User.email_unique" ON "public"."User"("email")

CREATE INDEX "User.email_index" ON "public"."User"("email")

ALTER TABLE "public"."Post" ADD FOREIGN KEY ("authorId")REFERENCES "public"."User"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Tag" ADD FOREIGN KEY ("postId")REFERENCES "public"."Post"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20201020153527-initial
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,49 @@
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+generator prisma_client {
+  provider = "prisma-client-js"
+}
+
+model User {
+  id        String   @default(cuid()) @id
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+  name      String?
+  posts     Post[]
+  rating    Float
+  roles     UserRole[]
+  email     String @unique
+  password  String
+
+  @@index([email])
+}
+
+enum UserRole {
+  ADMIN
+  EDITOR
+}
+
+model Post {
+  id       String     @default(cuid()) @id
+  title    String
+  tags     Tag[]
+  blogId   Int?
+  status   PostStatus
+  authorId String?
+  author   User?      @relation(fields: [authorId], references: [id])
+}
+
+enum PostStatus {
+  DRAFT
+  PUBLISHED
+}
+
+model Tag {
+  id     Int    @default(autoincrement()) @id
+  value  String
+  postId String?
+  post   Post?  @relation(fields: [postId], references: [id])
+}
```


